{"version":3,"sources":["../src/aiassessment.js"],"names":["define","$","Ajax","Notification","setup","init","self","$document","document","on","$userInfo","find","instanceId","attr","userid","gradenavpanel","closest","data","redirectUserGrading","call","methodname","args","assignid","then","response","dispatchEvent","CustomEvent","detail","catch","exception","e","stopPropagation","url","URL","location","href","searchParams","delete","append","toString"],"mappings":"AAsBAA,OAAM,gCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAAD,CAA+C,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgC,CACjF,MAAO,CACHC,KAAK,GADF,CAEHC,IAAI,CAAE,eAAW,IACTC,CAAAA,CAAI,CAAG,IADE,CAETC,CAAS,CAAGN,CAAC,CAACO,QAAD,CAFJ,CAGbD,CAAS,CAACE,EAAV,CAAa,qBAAb,CAAoC,UAAW,IACvCC,CAAAA,CAAS,CAAGH,CAAS,CAACI,IAAV,CAAe,6BAAf,CAD2B,CAEvCC,CAAU,CAAGF,CAAS,CAACG,IAAV,CAAe,mBAAf,CAF0B,CAGvCC,CAAM,CAAGJ,CAAS,CAACG,IAAV,CAAe,aAAf,CAH8B,CAI3C,GAAI,CAACC,CAAL,CAAa,CACT,GAAIC,CAAAA,CAAa,CAAGL,CAAS,CAACM,OAAV,CAAkB,4CAAlB,CAApB,CACAF,CAAM,CAAGC,CAAa,CAACE,IAAd,CAAmB,cAAnB,CACZ,CACD,GAAIX,CAAI,CAACF,KAAT,CAAgB,CACZE,CAAI,CAACY,mBAAL,CAAyBJ,CAAzB,EACA,MACH,CACDZ,CAAI,CAACiB,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,uCADL,CAEPC,IAAI,CAAE,CACFC,QAAQ,CAAEV,CADR,CAEFE,MAAM,CAAEA,CAFN,CAFC,CAAD,CAAV,EAMI,CANJ,EAMOS,IANP,CAMY,SAASC,CAAT,CAAmB,CAC3BlB,CAAI,CAACF,KAAL,IACAI,QAAQ,CAACiB,aAAT,CAAuB,GAAIC,CAAAA,WAAJ,CAAgB,yBAAhB,CAA2C,CAC9DC,MAAM,CAAEH,CADsD,CAA3C,CAAvB,EAGA,MAAO,KACV,CAZD,EAYGI,KAZH,CAYSzB,CAAY,CAAC0B,SAZtB,CAaH,CAzBD,EAyBGpB,EAzBH,CAyBM,cAzBN,CAyBsB,SAASqB,CAAT,CAAYhB,CAAZ,CAAoB,CACtC,GAAIR,CAAI,CAACF,KAAT,CAAgB,CACZ0B,CAAC,CAACC,eAAF,GACAzB,CAAI,CAACY,mBAAL,CAAyBJ,CAAzB,CACH,CACJ,CA9BD,CA+BH,CApCE,CAqCHI,mBAAmB,CAAE,6BAASJ,CAAT,CAAiB,CAClC,GAAIkB,CAAAA,CAAG,CAAG,GAAIC,CAAAA,GAAJ,CAAQC,QAAQ,CAACC,IAAjB,CAAV,CACAH,CAAG,CAACI,YAAJ,CAAiBC,MAAjB,CAAwB,QAAxB,EACAL,CAAG,CAACI,YAAJ,CAAiBE,MAAjB,CAAwB,QAAxB,CAAkCxB,CAAlC,EACAoB,QAAQ,CAACC,IAAT,CAAgBH,CAAG,CAACO,QAAJ,EACnB,CA1CE,CA4CV,CA7CK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * LearnWise assessment module\n *\n * @module     local_learnwise/aiassessment\n * @copyright  2025 LearnWise <help@learnwise.ai>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n    return {\n        setup: false,\n        init: function() {\n            var self = this;\n            var $document = $(document);\n            $document.on('finish-loading-user', function() {\n                var $userInfo = $document.find('[data-region=\"user-info\"]');\n                var instanceId = $userInfo.attr('data-assignmentid');\n                var userid = $userInfo.attr('data-userid');\n                if (!userid) {\n                    var gradenavpanel = $userInfo.closest('[data-region=\"grading-navigation-panel\"]');\n                    userid = gradenavpanel.data('first-userid');\n                }\n                if (self.setup) {\n                    self.redirectUserGrading(userid);\n                    return;\n                }\n                Ajax.call([{\n                    methodname: 'local_learnwise_assign_get_submission',\n                    args: {\n                        assignid: instanceId,\n                        userid: userid\n                    }\n                }])[0].then(function(response) {\n                    self.setup = true;\n                    document.dispatchEvent(new CustomEvent('initLearnWiseAssessment', {\n                        detail: response,\n                    }));\n                    return null;\n                }).catch(Notification.exception);\n            }).on('user-changed', function(e, userid) {\n                if (self.setup) {\n                    e.stopPropagation();\n                    self.redirectUserGrading(userid);\n                }\n            });\n        },\n        redirectUserGrading: function(userid) {\n            var url = new URL(location.href);\n            url.searchParams.delete('userid');\n            url.searchParams.append('userid', userid);\n            location.href = url.toString();\n        }\n    };\n});"],"file":"aiassessment.min.js"}