{"version":3,"file":"aiassessment.min.js","sources":["../src/aiassessment.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * LearnWise assessment module\n *\n * @module     local_learnwise/aiassessment\n * @copyright  2025 LearnWise <help@learnwise.ai>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n    return {\n        setup: false,\n        init: function() {\n            var self = this;\n            var $document = $(document);\n            $document.on('finish-loading-user', function() {\n                var $userInfo = $document.find('[data-region=\"user-info\"]');\n                var instanceId = $userInfo.attr('data-assignmentid');\n                var userid = $userInfo.attr('data-userid');\n                if (!userid) {\n                    var gradenavpanel = $userInfo.closest('[data-region=\"grading-navigation-panel\"]');\n                    userid = gradenavpanel.data('first-userid');\n                }\n                if (self.setup) {\n                    self.redirectUserGrading(userid);\n                    return;\n                }\n                Ajax.call([{\n                    methodname: 'local_learnwise_assign_get_submission',\n                    args: {\n                        assignid: instanceId,\n                        userid: userid\n                    }\n                }])[0].then(function(response) {\n                    self.setup = true;\n                    document.dispatchEvent(new CustomEvent('initLearnWiseAssessment', {\n                        detail: response,\n                    }));\n                    return null;\n                }).catch(Notification.exception);\n            }).on('user-changed', function(e, userid) {\n                if (self.setup) {\n                    e.stopPropagation();\n                    self.redirectUserGrading(userid);\n                }\n            });\n        },\n        redirectUserGrading: function(userid) {\n            var url = new URL(location.href);\n            url.searchParams.delete('userid');\n            url.searchParams.append('userid', userid);\n            location.href = url.toString();\n        }\n    };\n});"],"names":["define","$","Ajax","Notification","setup","init","self","this","$document","document","on","$userInfo","find","instanceId","attr","userid","closest","data","redirectUserGrading","call","methodname","args","assignid","then","response","dispatchEvent","CustomEvent","detail","catch","exception","e","stopPropagation","url","URL","location","href","searchParams","delete","append","toString"],"mappings":";;;;;;;AAsBAA,sCAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,oBAC5D,CACHC,OAAO,EACPC,KAAM,eACEC,KAAOC,KACPC,UAAYP,EAAEQ,UAClBD,UAAUE,GAAG,uBAAuB,eAC5BC,UAAYH,UAAUI,KAAK,6BAC3BC,WAAaF,UAAUG,KAAK,qBAC5BC,OAASJ,UAAUG,KAAK,eACvBC,SAEDA,OADoBJ,UAAUK,QAAQ,4CACfC,KAAK,iBAE5BX,KAAKF,MACLE,KAAKY,oBAAoBH,QAG7Bb,KAAKiB,KAAK,CAAC,CACPC,WAAY,wCACZC,KAAM,CACFC,SAAUT,WACVE,OAAQA,WAEZ,GAAGQ,MAAK,SAASC,iBACjBlB,KAAKF,OAAQ,EACbK,SAASgB,cAAc,IAAIC,YAAY,0BAA2B,CAC9DC,OAAQH,YAEL,QACRI,MAAMzB,aAAa0B,cACvBnB,GAAG,gBAAgB,SAASoB,EAAGf,QAC1BT,KAAKF,QACL0B,EAAEC,kBACFzB,KAAKY,oBAAoBH,aAIrCG,oBAAqB,SAASH,YACtBiB,IAAM,IAAIC,IAAIC,SAASC,MAC3BH,IAAII,aAAaC,OAAO,UACxBL,IAAII,aAAaE,OAAO,SAAUvB,QAClCmB,SAASC,KAAOH,IAAIO"}