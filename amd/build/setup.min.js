define([M.cfg.wwwroot+"/local/learnwise/vendorjs/zenorocha/clipboard.min.js","core/str","core/notification","core/fragment","core/config","core/templates"],function(a,b,c,d,e,f){function g(){u.floatingButtonAssistantId.addEventListener("input",function(a){t.floatingButtonAssistantId=a.target.value,k()}),u.ltiAssistantId&&u.ltiAssistantId.addEventListener("input",function(a){t.ltiAssistantId=a.target.value,m()}),u.aiAssessmentAssistantId&&u.aiAssessmentAssistantId.addEventListener("input",function(a){t.aiAssessmentAssistantId=a.target.value,n()}),u.floatingButtonSwitch.addEventListener("click",function(){h()&&(t.showFloatingButton=!t.showFloatingButton,k())}),u.webServicesSwitch.addEventListener("click",function(){t.webServicesEnabled=!t.webServicesEnabled,p()}),u.liveApiSwitch.addEventListener("click",function(){t.liveApiEnabled=!t.liveApiEnabled,q()}),u.aiAssessmentSwitch.addEventListener("click",function(){t.aiAssessmentEnabled=!t.aiAssessmentEnabled,n()}),u.courseIds.addEventListener("input",function(a){t.courseIds=a.target.value,o()}),u.ltiRemovalModal.addEventListener("click",function(a){a.target===u.closeLtiModal&&r(),a.target===u.confirmLtiRemoval&&s(),a.target===u.ltiRemovalModal&&r()});var d=document.querySelectorAll('input[name="environment"]');d.forEach(function(a){a.checked&&(t.environment=a.value),a.addEventListener("change",function(a){a.target.checked&&(t.environment=a.target.value,l())})}),u.ltiSwitch&&u.ltiSwitch.addEventListener("click",function(){j()&&(t.ltiEnabled?u.ltiRemovalModal.style.display="flex":(t.ltiEnabled=!0,m()))});var e=new a(".copy-btn");e.on("success",function(a){a.clearSelection(),b.get_string("copied","local_learnwise").then(function(a){return t.showToast?require(["core/toast"],function(b){b.add(a)}):alert(a),null})["catch"](c.exception)})}function h(){return t.floatingButtonAssistantId.trim().length>0}function i(){return t.aiAssessmentAssistantId.trim().length>0}function j(){return t.ltiAssistantId.trim().length>0}function k(){var a=h();a?(u.floatingButtonSwitch.classList.remove("disabled"),u.floatingButtonSwitchWrapper.style.cursor="pointer",u.floatingButtonTooltip.style.display="none",t.showFloatingButton?(u.floatingButtonSwitch.classList.add("active"),b.get_string("statusenabled","local_learnwise").then(function(a){return u.floatingButtonStatus.textContent=a,null}).fail(c.exception)):(u.floatingButtonSwitch.classList.remove("active"),b.get_string("statusdisabled","local_learnwise").then(function(a){return u.floatingButtonStatus.textContent=a,null}).fail(c.exception))):(u.floatingButtonSwitch.classList.remove("active"),u.floatingButtonSwitch.classList.add("disabled"),u.floatingButtonSwitchWrapper.style.cursor="not-allowed",b.get_string("statusdisabled","local_learnwise").then(function(a){return u.floatingButtonStatus.textContent=a,null}).fail(c.exception),t.showFloatingButton=!1),u.form.elements.floatingButtonStatus.value=t.showFloatingButton?1:0}function l(){u.ltiConfig&&j()&&t.ltiEnabled&&d.loadFragment("local_learnwise","process_setup",e.contextid,{formdata:"enablelti="+(t.ltiEnabled?1:0)+"&assistantid="+encodeURIComponent(u.ltiAssistantId.value)+"&environment="+encodeURIComponent(t.environment)}).then(function(a,b){return f.replaceNodeContents(u.ltiConfig,a,b),null})["catch"](c.exception)}function m(){if(u.ltiAssistantId){var a=j();a?(u.ltiSwitch.classList.remove("disabled"),u.ltiSwitchWrapper.style.cursor="pointer",u.ltiTooltip.style.display="none",t.ltiEnabled?(u.ltiSwitch.classList.add("active"),b.get_string("statusenabled","local_learnwise").then(function(a){return u.ltiStatus.textContent=a,null})["catch"](c.exception),u.ltiConfig.style.display="block"):(u.ltiSwitch.classList.remove("active"),b.get_string("statusdisabled","local_learnwise").then(function(a){return u.ltiStatus.textContent=a,null})["catch"](c.exception),u.ltiConfig.style.display="none"),l()):(u.ltiSwitch.classList.remove("active"),u.ltiSwitch.classList.add("disabled"),u.ltiSwitchWrapper.style.cursor="not-allowed",b.get_string("statusdisabled","local_learnwise").then(function(a){return u.ltiStatus.textContent=a,null})["catch"](c.exception),u.ltiConfig.style.display="none",t.ltiEnabled=!1),u.form.elements.ltiStatus.value=t.ltiEnabled?1:0}}function n(){if(u.aiAssessmentAssistantId){var a=i();a?(u.aiAssessmentSwitch.classList.remove("disabled"),u.aiAssessmentSwitchWrapper.style.cursor="pointer",u.aiAssessmentTooltip.style.display="none",t.aiAssessmentEnabled?(u.aiAssessmentSwitch.classList.add("active"),b.get_string("statusenabled","local_learnwise").then(function(a){return u.aiAssessmentStatus.textContent=a,null})["catch"](c.exception)):(u.aiAssessmentSwitch.classList.remove("active"),b.get_string("statusdisabled","local_learnwise").then(function(a){return u.aiAssessmentStatus.textContent=a,null})["catch"](c.exception))):(u.aiAssessmentSwitch.classList.remove("active"),u.aiAssessmentSwitch.classList.add("disabled"),u.aiAssessmentSwitchWrapper.style.cursor="not-allowed",b.get_string("statusdisabled","local_learnwise").then(function(a){return u.aiAssessmentStatus.textContent=a,null})["catch"](c.exception),t.aiAssessmentEnabled=!1),u.form.elements.aiAssessmentStatus.value=t.aiAssessmentEnabled?1:0}}function o(){var a=/^(\d+)(,\d+)*$/,b=document.getElementById("save-btn"),c=u.courseIds,d=(t.courseIds||"").trim();if(!d)return c.classList.remove("border-danger"),b.disabled=!1,void(b.className="save-btn");var e=a.test(t.courseIds);c.classList.toggle("border-danger",!e),b.disabled=!e,b.className=e?"save-btn":"save-btn bg-gray text-dark"}function p(){t.webServicesEnabled?(u.webServicesSwitch.classList.add("active"),b.get_string("statusenabled","local_learnwise").then(function(a){return u.webServicesStatus.textContent=a,null})["catch"](c.exception),u.webServicesConfig.style.display="block"):(u.webServicesSwitch.classList.remove("active"),b.get_string("statusdisabled","local_learnwise").then(function(a){return u.webServicesStatus.textContent=a,null})["catch"](c.exception),u.webServicesConfig.style.display="none"),d.loadFragment("local_learnwise","process_setup",e.contextid,{formdata:"enablewebservice="+(t.webServicesEnabled?1:0)}).then(function(a,b){return f.replaceNodeContents(u.webServicesConfig,a,b),null})["catch"](c.exception),u.form.elements.webServicesStatus.value=t.webServicesEnabled?1:0}function q(){t.liveApiEnabled?(u.liveApiSwitch.classList.add("active"),b.get_string("statusenabled","local_learnwise").then(function(a){return u.liveApiStatus.textContent=a,null})["catch"](c.exception),u.liveApiConfig.style.display="block"):(u.liveApiSwitch.classList.remove("active"),b.get_string("statusdisabled","local_learnwise").then(function(a){return u.liveApiStatus.textContent=a,null})["catch"](c.exception),u.liveApiConfig.style.display="none"),u.form.elements.liveApiStatus.value=t.liveApiEnabled?1:0}function r(){u.ltiRemovalModal.style.display="none"}function s(){t.ltiEnabled=!1,m(),r()}var t={environment:"sandbox",floatingButtonAssistantId:"",showFloatingButton:!1,ltiAssistantId:"",ltiEnabled:!1,webServicesEnabled:!1,liveApiEnabled:!1,aiAssessmentEnabled:!1,courseIds:"",aiAssessmentAssistantId:""},u={form:document.getElementById("form1"),floatingButtonAssistantId:document.getElementById("floatingButtonAssistantId"),floatingButtonSwitch:document.getElementById("floatingButtonSwitch"),floatingButtonStatus:document.getElementById("floatingButtonStatus"),floatingButtonSwitchWrapper:document.getElementById("floatingButtonSwitchWrapper"),floatingButtonTooltip:document.getElementById("floatingButtonTooltip"),ltiAssistantId:document.getElementById("ltiAssistantId"),ltiSwitch:document.getElementById("ltiSwitch"),ltiStatus:document.getElementById("ltiStatus"),ltiSwitchWrapper:document.getElementById("ltiSwitchWrapper"),ltiTooltip:document.getElementById("ltiTooltip"),ltiConfig:document.getElementById("ltiConfig"),webServicesSwitch:document.getElementById("webServicesSwitch"),webServicesStatus:document.getElementById("webServicesStatus"),webServicesConfig:document.getElementById("webServicesConfig"),liveApiSwitch:document.getElementById("liveApiSwitch"),liveApiStatus:document.getElementById("liveApiStatus"),liveApiConfig:document.getElementById("liveApiConfig"),ltiRemovalModal:document.getElementById("ltiRemovalModal"),closeLtiModal:document.getElementById("closeLtiModal"),confirmLtiRemoval:document.getElementById("confirmLtiRemoval"),aiAssessmentSwitch:document.getElementById("aiAssessmentSwitch"),aiAssessmentAssistantId:document.getElementById("aiAssessmentAssistantId"),aiAssessmentSwitchWrapper:document.getElementById("aiAssessmentSwitchWrapper"),aiAssessmentTooltip:document.getElementById("aiAssessmentTooltip"),aiAssessmentStatus:document.getElementById("aiAssessmentStatus"),courseIds:document.getElementById("courseIds")};return u.floatingButtonAssistantId&&(t.floatingButtonAssistantId=u.floatingButtonAssistantId.value),u.ltiAssistantId&&(t.ltiAssistantId=u.ltiAssistantId.value),u.aiAssessmentAssistantId&&(t.aiAssessmentAssistantId=u.aiAssessmentAssistantId.value),u.floatingButtonStatus&&(t.showFloatingButton=1===parseInt(u.form.elements.floatingButtonStatus.value)),u.ltiStatus&&(t.ltiEnabled=1===parseInt(u.form.elements.ltiStatus.value)),u.webServicesStatus&&(t.webServicesEnabled=1===parseInt(u.form.elements.webServicesStatus.value)),u.liveApiStatus&&(t.liveApiEnabled=1===parseInt(u.form.elements.liveApiStatus.value)),u.aiAssessmentStatus&&(t.aiAssessmentEnabled=1===parseInt(u.form.elements.aiAssessmentStatus.value)),u.courseIds&&(t.courseIds=u.courseIds.value),{init:function(a){t.showToast=a,g(),k(),m(),p(),q(),n()}}});